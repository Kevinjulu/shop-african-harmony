import{j as e}from"./ui-vendor-DUvlyADh.js";import{m as g,u as f,r as d}from"./react-vendor-BVHdP9Rw.js";import{c as m,u as N,C as l,s as u,P as v,g as y,o as k,B as h,J as p}from"./index-hIbkmTRc.js";import{S as o}from"./separator-DgK7aHvU.js";import{M as b}from"./map-pin-B-4eU0U_.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=m("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=m("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=m("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),M=({orderId:s})=>{const{data:a,isLoading:r}=N({queryKey:["order-tracking",s],queryFn:async()=>{console.log("Fetching tracking updates for order:",s);const{data:t,error:c}=await u.from("order_tracking").select("*").eq("order_id",s).order("created_at",{ascending:!0});if(c)throw c;return t}});if(r)return e.jsx(l,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})});if(!(a!=null&&a.length))return e.jsx(l,{className:"p-6",children:e.jsx("p",{className:"text-gray-500",children:"No tracking information available yet."})});const i=t=>{switch(t.toLowerCase()){case"delivered":return e.jsx(_,{className:"w-6 h-6 text-green-500"});case"in_transit":return e.jsx(C,{className:"w-6 h-6 text-blue-500"});default:return e.jsx(v,{className:"w-6 h-6 text-gray-500"})}};return e.jsx(l,{className:"p-6",children:e.jsx("div",{className:"space-y-6",children:a.map((t,c)=>e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:i(t.status)}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-medium",children:t.status}),e.jsx("p",{className:"text-sm text-gray-500",children:t.location}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(t.created_at).toLocaleString()}),t.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.notes})]})]},t.id))})})},O=({order:s})=>{const{formatPrice:a}=y();return e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"font-semibold",children:["Order #",s.id]}),e.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4"}),"Placed on ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:a(s.total_amount)}),e.jsx("span",{className:"inline-block px-2 py-1 text-xs rounded-full bg-primary/10 text-primary",children:s.status})]})]})},D=({items:s})=>{const{formatPrice:a}=y();return e.jsx("div",{className:"space-y-4",children:s.map(r=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:r.product.image_url||"/placeholder.svg",alt:r.product.name,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:r.product.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",r.quantity]})]}),e.jsx("p",{className:"font-medium",children:a(r.price_at_time*r.quantity)})]},r.id))})},q=({address:s})=>e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(b,{className:"w-4 h-4"}),"Shipping Address"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:s.full_name}),e.jsx("p",{children:s.address_line1}),s.address_line2&&e.jsx("p",{children:s.address_line2}),e.jsxs("p",{children:[s.city,", ",s.state," ",s.postal_code]}),e.jsx("p",{children:s.country})]})]}),T=()=>{const{orderId:s}=g(),a=f(),{user:r}=k(),[i,t]=d.useState(null),[c,j]=d.useState(!0);return d.useEffect(()=>{(async()=>{if(!s||!r){a("/");return}try{const{data:n,error:x}=await u.from("orders").select(`
            *,
            shipping_address:shipping_addresses(*),
            items:order_items(
              *,
              product:products(name, image_url)
            )
          `).eq("id",s).eq("user_id",r.id).single();if(x)throw x;if(!n){p.error("Order not found"),a("/");return}t(n)}catch(n){console.error("Error fetching order:",n),p.error("Failed to load order details")}finally{j(!1)}})()},[s,r,a]),c?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})}):i?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-green-600",children:"Order Confirmed!"}),e.jsx("p",{className:"text-gray-600",children:"Thank you for your order. We'll send you a confirmation email shortly."})]}),e.jsxs(l,{className:"p-6 space-y-6",children:[e.jsx(O,{order:i}),e.jsx(o,{}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Items"}),e.jsx(D,{items:i.items})]}),e.jsx(o,{}),i.shipping_address&&e.jsxs(e.Fragment,{children:[e.jsx(q,{address:i.shipping_address}),e.jsx(o,{})]}),i.tracking_number&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Tracking Information"}),e.jsx(M,{orderId:i.id})]})]}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx(h,{onClick:()=>a("/"),children:"Continue Shopping"}),e.jsx(h,{variant:"outline",onClick:()=>a("/account/orders"),children:"View All Orders"})]})]})}):null};export{T as default};
//# sourceMappingURL=OrderConfirmation-HbMVY5tT.js.map
