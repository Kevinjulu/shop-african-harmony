import{d as q,a as _,j as e,P,g as R,f as Z,e as M,o as ee,p as se,R as ae,I as re}from"./ui-vendor-DUvlyADh.js";import{r as u,u as te}from"./react-vendor-BVHdP9Rw.js";import{c as ne,p as oe,q as ie,k as G,r as ce,s as C,J as b,g as A,C as w,t as E,v as le,I as g,B as D,l as de,o as ue}from"./index-hIbkmTRc.js";import{L as p}from"./label-DytFwINh.js";import{S as F}from"./separator-DgK7aHvU.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=ne("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);var k="Radio",[pe,O]=q(k),[he,xe]=pe(k),L=u.forwardRef((r,t)=>{const{__scopeRadio:s,name:a,checked:o=!1,required:n,disabled:m,value:i="on",onCheck:h,form:f,...y}=r,[x,l]=u.useState(null),c=_(t,j=>l(j)),v=u.useRef(!1),d=x?f||!!x.closest("form"):!0;return e.jsxs(he,{scope:s,checked:o,disabled:m,children:[e.jsx(P.button,{type:"button",role:"radio","aria-checked":o,"data-state":V(o),"data-disabled":m?"":void 0,disabled:m,value:i,...y,ref:c,onClick:R(r.onClick,j=>{o||h==null||h(),d&&(v.current=j.isPropagationStopped(),v.current||j.stopPropagation())})}),d&&e.jsx(fe,{control:x,bubbles:!v.current,name:a,value:i,checked:o,required:n,disabled:m,form:f,style:{transform:"translateX(-100%)"}})]})});L.displayName=k;var z="RadioIndicator",B=u.forwardRef((r,t)=>{const{__scopeRadio:s,forceMount:a,...o}=r,n=xe(z,s);return e.jsx(Z,{present:a||n.checked,children:e.jsx(P.span,{"data-state":V(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:t})})});B.displayName=z;var fe=r=>{const{control:t,checked:s,bubbles:a=!0,...o}=r,n=u.useRef(null),m=oe(s),i=ie(t);return u.useEffect(()=>{const h=n.current,f=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(f,"checked").set;if(m!==s&&x){const l=new Event("click",{bubbles:a});x.call(h,s),h.dispatchEvent(l)}},[m,s,a]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:s,...o,tabIndex:-1,ref:n,style:{...r.style,...i,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function V(r){return r?"checked":"unchecked"}var ye=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],I="RadioGroup",[ve,Me]=q(I,[M,O]),T=M(),K=O(),[je,ge]=ve(I),$=u.forwardRef((r,t)=>{const{__scopeRadioGroup:s,name:a,defaultValue:o,value:n,required:m=!1,disabled:i=!1,orientation:h,dir:f,loop:y=!0,onValueChange:x,...l}=r,c=T(s),v=ee(f),[d,j]=se({prop:n,defaultProp:o,onChange:x});return e.jsx(je,{scope:s,name:a,required:m,disabled:i,value:d,onValueChange:j,children:e.jsx(ae,{asChild:!0,...c,orientation:h,dir:v,loop:y,children:e.jsx(P.div,{role:"radiogroup","aria-required":m,"aria-orientation":h,"data-disabled":i?"":void 0,dir:v,...l,ref:t})})})});$.displayName=I;var U="RadioGroupItem",H=u.forwardRef((r,t)=>{const{__scopeRadioGroup:s,disabled:a,...o}=r,n=ge(U,s),m=n.disabled||a,i=T(s),h=K(s),f=u.useRef(null),y=_(t,f),x=n.value===o.value,l=u.useRef(!1);return u.useEffect(()=>{const c=d=>{ye.includes(d.key)&&(l.current=!0)},v=()=>l.current=!1;return document.addEventListener("keydown",c),document.addEventListener("keyup",v),()=>{document.removeEventListener("keydown",c),document.removeEventListener("keyup",v)}},[]),e.jsx(re,{asChild:!0,...i,focusable:!m,active:x,children:e.jsx(L,{disabled:m,required:n.required,checked:x,...h,...o,name:n.name,ref:y,onCheck:()=>n.onValueChange(o.value),onKeyDown:R(c=>{c.key==="Enter"&&c.preventDefault()}),onFocus:R(o.onFocus,()=>{var c;l.current&&((c=f.current)==null||c.click())})})})});H.displayName=U;var Ne="RadioGroupIndicator",J=u.forwardRef((r,t)=>{const{__scopeRadioGroup:s,...a}=r,o=K(s);return e.jsx(B,{...o,...a,ref:t})});J.displayName=Ne;var Q=$,W=H,be=J;const S=u.forwardRef(({className:r,...t},s)=>e.jsx(Q,{className:G("grid gap-2",r),...t,ref:s}));S.displayName=Q.displayName;const N=u.forwardRef(({className:r,...t},s)=>e.jsx(W,{ref:s,className:G("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...t,children:e.jsx(be,{className:"flex items-center justify-center",children:e.jsx(ce,{className:"h-2.5 w-2.5 fill-current text-current"})})}));N.displayName=W.displayName;const we=async(r,t,s)=>({success:!0}),Ce=async(r,t,s)=>({success:!0}),Re=async(r,t,s)=>({success:!0}),Pe=async(r,t,s)=>({success:!0});class ke{static async initiatePayment(t,s){try{let a;switch(t){case"mpesa":if(!s.phoneNumber)throw new Error("Phone number required for M-Pesa");a=await we(s.amount,s.phoneNumber,s.orderId);break;case"paystack":if(!s.email)throw new Error("Email required for Paystack");a=await Ce(s.amount,s.email,s.orderId);break;case"flutterwave":if(!s.email)throw new Error("Email required for Flutterwave");a=await Re(s.amount,s.email,s.orderId);break;case"coingate":a=await Pe(s.amount,s.currency,s.orderId);break;default:throw new Error("Invalid payment provider")}return await C.from("payment_transactions").insert([{order_id:s.orderId,amount:s.amount,currency:s.currency,status:"pending",payment_details:a}]),a}catch(a){throw console.error("Payment initiation error:",a),b.error("Failed to initiate payment"),a}}static async verifyPayment(t){try{const{data:s,error:a}=await C.from("payment_transactions").select("*").eq("id",t).single();if(a)throw a;return s.status==="success"&&await C.from("orders").update({status:"paid"}).eq("id",s.order_id),s}catch(s){throw console.error("Payment verification error:",s),b.error("Failed to verify payment"),s}}}const Ie=({amount:r,orderId:t,onPaymentComplete:s})=>{const[a,o]=u.useState("mpesa"),[n,m]=u.useState({}),[i,h]=u.useState(!1),{formatPrice:f,currency:y}=A(),x=async()=>{try{h(!0),console.log("Initiating payment with:",{selectedMethod:a,details:n,amount:r,currency:y.code,orderId:t}),await ke.initiatePayment(a,{amount:r,currency:y.code,orderId:t,...n}),b.success("Payment initiated successfully"),s()}catch(l){console.error("Payment error:",l),b.error("Payment failed")}finally{h(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{value:a,onValueChange:l=>o(l),className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{className:"relative p-4 hover:border-orange-500 transition-colors cursor-pointer",children:[e.jsx(N,{value:"mpesa",id:"mpesa",className:"absolute right-4 top-4"}),e.jsxs(p,{htmlFor:"mpesa",className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-green-500 rounded-full",children:e.jsx(me,{className:"w-5 h-5 text-white"})}),e.jsx("span",{children:"M-Pesa"})]})]}),e.jsxs(w,{className:"relative p-4 hover:border-orange-500 transition-colors cursor-pointer",children:[e.jsx(N,{value:"paystack",id:"paystack",className:"absolute right-4 top-4"}),e.jsxs(p,{htmlFor:"paystack",className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-blue-500 rounded-full",children:e.jsx(E,{className:"w-5 h-5 text-white"})}),e.jsx("span",{children:"Paystack"})]})]}),e.jsxs(w,{className:"relative p-4 hover:border-orange-500 transition-colors cursor-pointer",children:[e.jsx(N,{value:"flutterwave",id:"flutterwave",className:"absolute right-4 top-4"}),e.jsxs(p,{htmlFor:"flutterwave",className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-purple-500 rounded-full",children:e.jsx(E,{className:"w-5 h-5 text-white"})}),e.jsx("span",{children:"Flutterwave"})]})]}),e.jsxs(w,{className:"relative p-4 hover:border-orange-500 transition-colors cursor-pointer",children:[e.jsx(N,{value:"coingate",id:"coingate",className:"absolute right-4 top-4"}),e.jsxs(p,{htmlFor:"coingate",className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-yellow-500 rounded-full",children:e.jsx(le,{className:"w-5 h-5 text-white"})}),e.jsx("span",{children:"Cryptocurrency"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[(a==="paystack"||a==="flutterwave")&&e.jsxs("div",{children:[e.jsx(p,{children:"Email"}),e.jsx(g,{type:"email",value:n.email||"",onChange:l=>m({...n,email:l.target.value}),placeholder:"Enter your email",className:"mt-1"})]}),a==="mpesa"&&e.jsxs("div",{children:[e.jsx(p,{children:"Phone Number"}),e.jsx(g,{type:"tel",value:n.phoneNumber||"",onChange:l=>m({...n,phoneNumber:l.target.value}),placeholder:"Enter M-Pesa number",className:"mt-1"})]}),e.jsx(D,{onClick:x,disabled:i,className:"w-full bg-orange-500 hover:bg-orange-600 text-white",children:i?"Processing...":`Pay ${f(r)}`})]})]})},Ge=()=>{const{items:r,clearCart:t}=de(),{formatPrice:s}=A(),{user:a}=ue(),o=te(),[n,m]=u.useState("standard"),[i,h]=u.useState({firstName:"",lastName:"",email:(a==null?void 0:a.email)||"",phone:"",address:"",city:"",state:"",zipCode:"",country:""}),f=r.reduce((d,j)=>d+j.price*j.quantity,0),y=n==="express"?20:10,x=f*.16,l=f+y+x,c=d=>{const{name:j,value:X}=d.target;h(Y=>({...Y,[j]:X}))},v=async d=>{if(d.preventDefault(),!a){b.error("Please sign in to complete your purchase"),o("/auth");return}b.success("Order placed successfully!"),t(),o("/")};return r.length===0?(o("/cart"),null):e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Checkout"}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Shipping Information"}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"firstName",children:"First Name"}),e.jsx(g,{id:"firstName",name:"firstName",value:i.firstName,onChange:c,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"lastName",children:"Last Name"}),e.jsx(g,{id:"lastName",name:"lastName",value:i.lastName,onChange:c,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"email",children:"Email"}),e.jsx(g,{id:"email",name:"email",type:"email",value:i.email,onChange:c,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"phone",children:"Phone"}),e.jsx(g,{id:"phone",name:"phone",type:"tel",value:i.phone,onChange:c,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"address",children:"Address"}),e.jsx(g,{id:"address",name:"address",value:i.address,onChange:c,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"city",children:"City"}),e.jsx(g,{id:"city",name:"city",value:i.city,onChange:c,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"state",children:"State"}),e.jsx(g,{id:"state",name:"state",value:i.state,onChange:c,required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"zipCode",children:"ZIP Code"}),e.jsx(g,{id:"zipCode",name:"zipCode",value:i.zipCode,onChange:c,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"country",children:"Country"}),e.jsx(g,{id:"country",name:"country",value:i.country,onChange:c,required:!0})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Shipping Method"}),e.jsxs(S,{value:n,onValueChange:m,className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{value:"standard",id:"standard"}),e.jsx(p,{htmlFor:"standard",children:"Standard Shipping (5-7 days)"})]}),e.jsx("span",{className:"font-medium",children:s(10)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{value:"express",id:"express"}),e.jsx(p,{htmlFor:"express",children:"Express Shipping (2-3 days)"})]}),e.jsx("span",{className:"font-medium",children:s(20)})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Payment Method"}),e.jsx(Ie,{amount:l,orderId:`ORDER-${Date.now()}`,onPaymentComplete:()=>{b.success("Payment successful!"),t(),o("/")}})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4",children:[r.map(d=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("img",{src:d.image_url,alt:d.name,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:d.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Quantity: ",d.quantity]})]})]}),e.jsx("p",{className:"font-medium",children:s(d.price*d.quantity)})]},d.id)),e.jsx(F,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsx("span",{children:s(f)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsx("span",{children:s(y)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Tax (16%)"}),e.jsx("span",{children:s(x)})]}),e.jsx(F,{}),e.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:s(l)})]})]})]})]}),e.jsx(D,{onClick:v,className:"w-full bg-primary hover:bg-primary/90 text-white font-medium py-3",children:"Place Order"})]})]})]})};export{Ge as default};
//# sourceMappingURL=Checkout-C7NB-ssA.js.map
