import{j as e}from"./ui-vendor-DUvlyADh.js";import{r as m}from"./react-vendor-BVHdP9Rw.js";import{c as M,I as g,B as y,X as $,J as v,o as z,s as u,N as R}from"./index-hIbkmTRc.js";import{T as H,a as J,b as V,c as I}from"./tabs-BxpNRUCr.js";import{F as b,a as w,b as N,c as P,d as C,U as K,u as O,e as Q,T as W,f as X,g as q,h as S,i as Y,j as F}from"./table-BKeV9QYJ.js";import{T as G}from"./textarea-EeofsJfB.js";import{S as A,a as E,b as L,c as U,d as h}from"./select-YRxIW6H_.js";import{P as Z}from"./plus-B4XmFN_P.js";import{T as B}from"./trash-2-DLKjyhPr.js";import"./label-DytFwINh.js";import"./index-BdQq_4o_.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=M("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),se=({form:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(b,{control:a.control,name:"name",render:({field:r})=>e.jsxs(w,{children:[e.jsx(N,{children:"Product Name"}),e.jsx(P,{children:e.jsx(g,{...r,placeholder:"Enter product name"})}),e.jsx(C,{})]})}),e.jsx(b,{control:a.control,name:"description",render:({field:r})=>e.jsxs(w,{children:[e.jsx(N,{children:"Description"}),e.jsx(P,{children:e.jsx(G,{...r,placeholder:"Enter product description",rows:4})}),e.jsx(C,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(b,{control:a.control,name:"price",render:({field:r})=>e.jsxs(w,{children:[e.jsx(N,{children:"Base Price"}),e.jsx(P,{children:e.jsx(g,{...r,type:"number",step:"0.01",onChange:n=>r.onChange(parseFloat(n.target.value))})}),e.jsx(C,{})]})}),e.jsx(b,{control:a.control,name:"inventory_quantity",render:({field:r})=>e.jsxs(w,{children:[e.jsx(N,{children:"Base Stock Quantity"}),e.jsx(P,{children:e.jsx(g,{...r,type:"number",onChange:n=>r.onChange(parseInt(n.target.value))})}),e.jsx(C,{})]})})]})]}),re=({form:a})=>e.jsx(b,{control:a.control,name:"category",render:({field:r})=>e.jsxs(w,{children:[e.jsx(N,{children:"Category"}),e.jsxs(A,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(P,{children:e.jsx(E,{children:e.jsx(L,{placeholder:"Select a category"})})}),e.jsxs(U,{children:[e.jsx(h,{value:"fashion",children:"Fashion & Clothing"}),e.jsx(h,{value:"art",children:"Art & Sculptures"}),e.jsx(h,{value:"jewelry",children:"Jewelry & Accessories"}),e.jsx(h,{value:"decor",children:"Home Decor"}),e.jsx(h,{value:"photography",children:"Photography"}),e.jsx(h,{value:"traditional",children:"Traditional Items"})]})]}),e.jsx(C,{})]})}),te=({form:a})=>e.jsx(b,{control:a.control,name:"status",render:({field:r})=>e.jsxs(w,{children:[e.jsx(N,{children:"Product Status"}),e.jsxs(A,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(P,{children:e.jsx(E,{children:e.jsx(L,{placeholder:"Select status"})})}),e.jsxs(U,{children:[e.jsx(h,{value:"draft",children:"Draft"}),e.jsx(h,{value:"published",children:"Published"}),e.jsx(h,{value:"out_of_stock",children:"Out of Stock"})]})]}),e.jsx(C,{})]})}),ae=({form:a})=>{const[r,n]=m.useState([]),x=()=>{n([...r,{size:"",color:"",sku:"",price:0,inventory_quantity:0}])},d=l=>{const i=r.filter((s,t)=>t!==l);n(i),a.setValue("variants",i)},o=(l,i,s)=>{const t=[...r];t[l]={...t[l],[i]:s},n(t),a.setValue("variants",t)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Variants"}),e.jsxs(y,{type:"button",variant:"outline",onClick:x,children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Add Variant"]})]}),r.map((l,i)=>e.jsxs("div",{className:"border p-4 rounded-lg space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(y,{type:"button",variant:"ghost",size:"sm",onClick:()=>d(i),children:e.jsx(B,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Size"}),e.jsx(g,{value:l.size,onChange:s=>o(i,"size",s.target.value),placeholder:"Size"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Color"}),e.jsx(g,{value:l.color,onChange:s=>o(i,"color",s.target.value),placeholder:"Color"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"SKU"}),e.jsx(g,{value:l.sku,onChange:s=>o(i,"sku",s.target.value),placeholder:"SKU"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Price"}),e.jsx(g,{type:"number",step:"0.01",value:l.price,onChange:s=>o(i,"price",parseFloat(s.target.value)),placeholder:"Price"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Stock"}),e.jsx(g,{type:"number",value:l.inventory_quantity,onChange:s=>o(i,"inventory_quantity",parseInt(s.target.value)),placeholder:"Stock"})]})]})]},i))]})},le=({onImagesSelect:a,maxImages:r=5})=>{const[n,x]=m.useState([]),[d,o]=m.useState([]),l=s=>{if(s.target.files){const t=Array.from(s.target.files);if(d.length+t.length>r){v.error(`Maximum ${r} images allowed`);return}if(t.filter(c=>!c.type.startsWith("image/")||c.size>5*1024*1024).length>0){v.error("Some files were invalid. Images must be less than 5MB");return}const f=[...d,...t];o(f),a(f),t.forEach(c=>{const p=new FileReader;p.onloadend=()=>{x(_=>[..._,p.result])},p.readAsDataURL(c)})}},i=s=>{const t=d.filter((f,c)=>c!==s),j=n.filter((f,c)=>c!==s);o(t),x(j),a(t)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(y,{type:"button",variant:"outline",onClick:()=>{var s;return(s=document.getElementById("multiple-image-upload"))==null?void 0:s.click()},children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Upload Images"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[d.length,"/",r," images"]})]}),e.jsx("input",{id:"multiple-image-upload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:l}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:n.map((s,t)=>e.jsxs("div",{className:"relative aspect-square",children:[e.jsx("img",{src:s,alt:`Preview ${t+1}`,className:"w-full h-full object-cover rounded-lg"}),e.jsx(y,{type:"button",variant:"ghost",size:"sm",className:"absolute top-2 right-2 bg-white/80 hover:bg-white",onClick:()=>i(t),children:e.jsx($,{className:"w-4 h-4"})})]},t))})]})},ie=({form:a,onImagesSelect:r})=>e.jsxs("div",{className:"space-y-8",children:[e.jsx(se,{form:a}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(re,{form:a}),e.jsx(te,{form:a})]}),e.jsx(le,{onImagesSelect:r,maxImages:5}),e.jsx(ae,{form:a})]}),ne=({onSuccess:a})=>{const[r,n]=m.useState(!1),[x,d]=m.useState([]),{user:o}=z(),l=O({defaultValues:{name:"",description:"",price:0,category:"",inventory_quantity:0,status:"draft",variants:[],sku:"",weight:0,dimensions:"",materials:"",tags:""}}),i=async s=>{if(!o){v.error("You must be logged in to add products");return}n(!0);try{const{data:t}=await u.from("vendor_profiles").select("id").eq("user_id",o.id).single();if(!t)throw new Error("Vendor profile not found");const{data:j,error:f}=await u.from("products").insert([{name:s.name,description:s.description,price:s.price,category:s.category,inventory_quantity:s.inventory_quantity,vendor_id:t.id,status:s.status}]).select().single();if(f)throw f;for(const[c,p]of x.entries()){const _=p.name.split(".").pop(),k=`${crypto.randomUUID()}.${_}`,{error:T}=await u.storage.from("product-images").upload(k,p);if(T)throw T;const{data:{publicUrl:D}}=u.storage.from("product-images").getPublicUrl(k);await u.from("product_images").insert([{product_id:j.id,image_url:D,is_primary:c===0,display_order:c}])}if(s.variants.length>0){const{error:c}=await u.from("product_variants").insert(s.variants.map(p=>({product_id:j.id,...p})));if(c)throw c}v.success("Product added successfully!"),l.reset(),d([]),a==null||a()}catch(t){console.error("Error adding product:",t),v.error("Failed to add product")}finally{n(!1)}};return e.jsx(Q,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(i),className:"space-y-8",children:[e.jsx(ie,{form:l,onImagesSelect:s=>d(s)}),e.jsx(y,{type:"submit",disabled:r,className:"w-full",children:r?"Adding Product...":"Add Product"})]})})},oe=({onEdit:a})=>{const[r,n]=m.useState([]),[x,d]=m.useState(!0),{user:o}=z(),l=async()=>{if(o)try{const{data:s}=await u.from("vendor_profiles").select("id").eq("user_id",o.id).single();if(!s)return;const{data:t,error:j}=await u.from("products").select("*").eq("vendor_id",s.id).order("created_at",{ascending:!1});if(j)throw j;n(t||[])}catch(s){console.error("Error fetching products:",s),v.error("Failed to load products")}finally{d(!1)}};m.useEffect(()=>{l()},[o]);const i=async s=>{try{const{error:t}=await u.from("products").delete().eq("id",s);if(t)throw t;v.success("Product deleted successfully"),l()}catch(t){console.error("Error deleting product:",t),v.error("Failed to delete product")}};return x?e.jsx("div",{children:"Loading products..."}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(q,{children:[e.jsx(S,{children:"Name"}),e.jsx(S,{children:"Category"}),e.jsx(S,{children:"Price"}),e.jsx(S,{children:"Stock"}),e.jsx(S,{children:"Actions"})]})}),e.jsx(Y,{children:r.map(s=>e.jsxs(q,{children:[e.jsx(F,{children:s.name}),e.jsx(F,{children:s.category}),e.jsxs(F,{children:["$",s.price.toFixed(2)]}),e.jsx(F,{children:s.stock}),e.jsx(F,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>a==null?void 0:a(s.id),children:e.jsx(ee,{className:"w-4 h-4"})}),e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>i(s.id),children:e.jsx(B,{className:"w-4 h-4 text-red-500"})})]})})]},s.id))})]})})},ye=()=>{const[a,r]=m.useState("list"),n=()=>{r("list")};return e.jsxs("div",{children:[e.jsx(R,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Product Management"}),e.jsxs(H,{value:a,onValueChange:r,children:[e.jsxs(J,{children:[e.jsx(V,{value:"list",children:"Product List"}),e.jsx(V,{value:"add",children:"Add Product"})]}),e.jsx(I,{value:"list",className:"mt-6",children:e.jsx(oe,{})}),e.jsx(I,{value:"add",className:"mt-6",children:e.jsx(ne,{onSuccess:n})})]})]})]})};export{ye as default};
//# sourceMappingURL=Products-C9z-Wv9w.js.map
