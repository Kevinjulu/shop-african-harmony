import{j as e}from"./ui-vendor-DUvlyADh.js";import{c as A,i as w,j as C,k as y,B as v,l as Z,g as F,m as H,J as g,n as O,s as D,u as $,U as Y,o as B}from"./index-hIbkmTRc.js";import{T as K,a as G,b as S,c as k}from"./tabs-BxpNRUCr.js";import{A as W,a as I,b as T,c as _}from"./accordion-dcv9FhMJ.js";import{r as N,L as J,m as Q}from"./react-vendor-BVHdP9Rw.js";import{D as V,a as ee}from"./dialog-C0nEe18y.js";import{M as se}from"./minus-DXWeOdVB.js";import{P as ae}from"./plus-B4XmFN_P.js";import{T as re}from"./textarea-EeofsJfB.js";import{t as h,c as te,e as le,d as ne,a as ie,g as P,m as R,b,f as ce}from"./en-US-D0KhEKBm.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=A("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=A("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),me=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{className:"aspect-square w-full rounded-lg"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[...Array(4)].map((s,a)=>e.jsx(w,{className:"aspect-square w-full rounded-md"},a))})]}),ue=({images:s,productName:a,isLoading:t})=>{var p,c,j;const[l,r]=N.useState(0),[n,o]=N.useState(!1),[i,x]=N.useState(!1),f=C();if(t)return e.jsx(me,{});const d=m=>{if(!n||f)return;const u=m.currentTarget,{left:q,top:L,width:X,height:z}=u.getBoundingClientRect(),E=(m.clientX-q)/X*100,U=(m.clientY-L)/z*100;u.style.transformOrigin=`${E}% ${U}%`};return e.jsxs("div",{className:"space-y-4",children:[f?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"relative aspect-square w-full",children:e.jsx("img",{src:((p=s[l])==null?void 0:p.url)||"/placeholder.svg",alt:a,className:"w-full h-full object-cover rounded-lg",onClick:()=>x(!0)})}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:s.map((m,u)=>e.jsx("button",{onClick:()=>r(u),className:y("flex-shrink-0 w-20 aspect-square relative rounded-md border-2 transition-all",l===u?"border-primary":"border-transparent"),children:e.jsx("img",{src:m.url,alt:`${a} view ${u+1}`,className:"w-full h-full object-cover rounded-md",loading:"lazy"})},u))})]}):e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx("div",{className:"space-y-2",children:s.map((m,u)=>e.jsx("button",{onClick:()=>r(u),className:y("w-full aspect-square relative overflow-hidden rounded-md border-2 transition-all",l===u?"border-primary":"border-transparent"),children:e.jsx("img",{src:m.url,alt:`${a} view ${u+1}`,className:"w-full h-full object-cover hover:opacity-80 transition-opacity",loading:"lazy"})},u))}),e.jsxs("div",{className:y("col-span-4 aspect-square relative overflow-hidden rounded-lg border border-gray-200 group",n?"cursor-zoom-out":"cursor-zoom-in"),onMouseMove:d,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:()=>x(!0),children:[e.jsx("img",{src:((c=s[l])==null?void 0:c.url)||"/placeholder.svg",alt:a,className:y("w-full h-full object-contain transition-transform duration-200",n?"scale-150":"scale-100"),loading:"eager"}),e.jsx("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-white p-2 rounded-full shadow-md",children:e.jsx(de,{className:"w-5 h-5 text-gray-600"})})})]})]}),e.jsx(V,{open:i,onOpenChange:x,children:e.jsx(ee,{className:"max-w-4xl p-0 bg-black/90",children:e.jsx("img",{src:((j=s[l])==null?void 0:j.url)||"/placeholder.svg",alt:a,className:"w-full h-full object-contain"})})})]})},xe=s=>({KE:"Kenya",NG:"Nigeria",GH:"Ghana",TZ:"Tanzania",US:"United States"})[s]||s,he=({quantity:s,setQuantity:a,max:t})=>e.jsxs("div",{className:"flex items-center border rounded-md",children:[e.jsx(v,{variant:"ghost",size:"icon",className:y("h-9 w-9",s<=1&&"opacity-50 cursor-not-allowed"),onClick:()=>a(Math.max(1,s-1)),disabled:s<=1,children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("span",{className:"px-4 py-2 min-w-[3rem] text-center",children:s}),e.jsx(v,{variant:"ghost",size:"icon",className:y("h-9 w-9",s>=t&&"opacity-50 cursor-not-allowed"),onClick:()=>a(Math.min(t,s+1)),disabled:s>=t,children:e.jsx(ae,{className:"w-4 h-4"})})]}),fe=({product:s})=>{const[a,t]=N.useState(1),{addToCart:l}=Z(),{formatPrice:r}=F(),n=C(),o=()=>{l(s,a),g.success(`Added ${a} ${a===1?"item":"items"} to cart - ${r(s.price*a)}`)},i=async()=>{try{await navigator.share({title:s.name,text:s.description,url:window.location.href})}catch{g.error("Sharing failed. Try copying the URL manually.")}},x=()=>{g.success("Added to wishlist!")};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-xl md:text-2xl font-bold text-primary",children:r(s.price)}),a>1&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Total: ",r(s.price*a)]})]}),e.jsxs("span",{className:"text-sm text-gray-500 flex items-center gap-2",children:["Product from ",xe(s.origin_country)]})]}),e.jsx("p",{className:"text-sm md:text-base text-gray-600",children:s.description}),e.jsxs("div",{className:y("flex items-center gap-4",n?"flex-col w-full":"flex-row"),children:[e.jsx(he,{quantity:a,setQuantity:t,max:s.stock}),e.jsx(v,{onClick:o,className:y("bg-primary hover:bg-primary/90",n&&"w-full"),children:"Add to Cart"}),e.jsxs("div",{className:y("flex gap-2",n&&"w-full"),children:[e.jsx(v,{variant:"outline",onClick:x,className:n&&"flex-1",children:e.jsx(H,{className:"h-5 w-5"})}),e.jsx(v,{variant:"outline",onClick:i,className:n&&"flex-1",children:e.jsx(oe,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"border-t pt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Category:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:s.category})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Stock:"}),e.jsxs("span",{className:"ml-2 text-gray-900",children:[s.stock," available"]})]})]})})]})},ge=({products:s,currentProductId:a})=>{const{formatPrice:t}=F(),l=C(),r=s.filter(n=>n.id!==a).slice(0,l?2:4);return e.jsxs("div",{className:"mt-8 md:mt-16",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold mb-4 md:mb-6",children:"Similar Products"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4",children:r.map(n=>e.jsxs(J,{to:`/product/${n.id}`,className:"group cursor-pointer",children:[e.jsx("div",{className:"aspect-square mb-2 overflow-hidden rounded-lg",children:e.jsx("img",{src:n.image_url||"/placeholder.svg",alt:n.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 group-hover:text-primary transition-colors line-clamp-2",children:n.name}),e.jsx("p",{className:"text-sm font-bold text-primary mt-1",children:t(n.price)})]},n.id))})]})},pe=({productId:s,onSuccess:a,onCancel:t})=>{const[l,r]=N.useState(0),[n,o]=N.useState(""),[i,x]=N.useState(!1),f=async d=>{if(d.preventDefault(),l===0){g.error("Please select a rating");return}x(!0);try{const{data:{user:p}}=await D.auth.getUser();if(!p){g.error("Please login to submit a review");return}const{error:c}=await D.from("reviews").insert([{product_id:s,user_id:p.id,rating:l,comment:n}]);if(c)throw c;g.success("Review submitted successfully!"),a==null||a(),r(0),o("")}catch(p){console.error("Error submitting review:",p),g.error("Failed to submit review. Please try again.")}finally{x(!1)}};return e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(d=>e.jsx("button",{type:"button",onClick:()=>r(d),className:"focus:outline-none",children:e.jsx(O,{className:`w-6 h-6 ${d<=l?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},d))}),e.jsx(re,{value:n,onChange:d=>o(d.target.value),placeholder:"Write your review here...",className:"min-h-[100px]"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[t&&e.jsx(v,{type:"button",variant:"outline",onClick:t,disabled:i,children:"Cancel"}),e.jsx(v,{type:"submit",disabled:i,children:i?"Submitting...":"Submit Review"})]})]})};function M(s,a){const t=h(s),l=h(a),r=t.getTime()-l.getTime();return r<0?-1:r>0?1:r}function je(s){return te(s,Date.now())}function ye(s){return a=>{const l=(s?Math[s]:Math.trunc)(a);return l===0?0:l}}function ve(s,a){return+h(s)-+h(a)}function Ne(s){const a=h(s);return a.setHours(23,59,59,999),a}function we(s){const a=h(s);return+Ne(a)==+le(a)}function be(s,a){const t=h(s),l=h(a),r=M(t,l),n=Math.abs(ne(t,l));let o;if(n<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*n);let i=M(t,l)===-r;we(h(s))&&n===1&&M(s,l)===1&&(i=!1),o=r*(n-Number(i))}return o===0?0:o}function Me(s,a,t){const l=ve(s,a)/1e3;return ye(t==null?void 0:t.roundingMethod)(l)}function De(s,a,t){const l=ce(),r=(t==null?void 0:t.locale)??l.locale??ie,n=2520,o=M(s,a);if(isNaN(o))throw new RangeError("Invalid time value");const i=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o});let x,f;o>0?(x=h(a),f=h(s)):(x=h(s),f=h(a));const d=Me(f,x),p=(P(f)-P(x))/1e3,c=Math.round((d-p)/60);let j;if(c<2)return t!=null&&t.includeSeconds?d<5?r.formatDistance("lessThanXSeconds",5,i):d<10?r.formatDistance("lessThanXSeconds",10,i):d<20?r.formatDistance("lessThanXSeconds",20,i):d<40?r.formatDistance("halfAMinute",0,i):d<60?r.formatDistance("lessThanXMinutes",1,i):r.formatDistance("xMinutes",1,i):c===0?r.formatDistance("lessThanXMinutes",1,i):r.formatDistance("xMinutes",c,i);if(c<45)return r.formatDistance("xMinutes",c,i);if(c<90)return r.formatDistance("aboutXHours",1,i);if(c<R){const m=Math.round(c/60);return r.formatDistance("aboutXHours",m,i)}else{if(c<n)return r.formatDistance("xDays",1,i);if(c<b){const m=Math.round(c/R);return r.formatDistance("xDays",m,i)}else if(c<b*2)return j=Math.round(c/b),r.formatDistance("aboutXMonths",j,i)}if(j=be(f,x),j<12){const m=Math.round(c/b);return r.formatDistance("xMonths",m,i)}else{const m=j%12,u=Math.trunc(j/12);return m<3?r.formatDistance("aboutXYears",u,i):m<9?r.formatDistance("overXYears",u,i):r.formatDistance("almostXYears",u+1,i)}}function Se(s,a){return De(s,je(s),a)}const ke=({productId:s})=>{const{data:a,isLoading:t}=$({queryKey:["reviews",s],queryFn:async()=>{const{data:l,error:r}=await D.from("reviews").select(`
          *,
          profiles (
            username,
            full_name,
            avatar_url
          )
        `).eq("product_id",s).order("created_at",{ascending:!1});if(r)throw r;return l}});return t?e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(l=>e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]},l))}):a!=null&&a.length?e.jsx("div",{className:"space-y-6",children:a.map(l=>e.jsxs("div",{className:"border-b pb-6 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l.profiles.avatar_url?e.jsx("img",{src:l.profiles.avatar_url,alt:l.profiles.username||"User",className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(Y,{className:"w-4 h-4 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:l.profiles.full_name||l.profiles.username||"Anonymous"}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(r=>e.jsx(O,{className:`w-4 h-4 ${r<=l.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},r))})]})]}),e.jsx("span",{className:"text-sm text-gray-500",children:Se(new Date(l.created_at),{addSuffix:!0})})]}),l.comment&&e.jsx("p",{className:"text-gray-600 mt-2",children:l.comment})]},l.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No reviews yet. Be the first to review this product!"})},Ce=({productId:s})=>{const[a,t]=N.useState(!1),{user:l}=B(),r=()=>{if(!l){g.error("Please login to write a review");return}t(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Customer Reviews"}),!a&&e.jsx(v,{onClick:r,children:"Write a Review"})]}),a&&e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx(pe,{productId:s,onSuccess:()=>t(!1),onCancel:()=>t(!1)})}),e.jsx(ke,{productId:s})]})},Le=()=>{var l;const{id:s}=Q(),{data:a,isLoading:t}=$({queryKey:["product",s],queryFn:async()=>{if(console.log("Fetching product details for ID:",s),!s)throw console.error("No product ID provided"),new Error("No product ID provided");try{const{data:r,error:n}=await D.from("products").select(`
            *,
            product_images (
              id,
              image_url,
              is_primary,
              display_order
            )
          `).eq("id",s).maybeSingle();if(n)throw console.error("Error fetching products:",n),g.error("Failed to load product details"),n;if(!r)throw console.error("Product not found"),g.error("Product not found"),new Error("Product not found");return console.log("Found product:",r),r}catch(r){throw console.error("Failed to fetch product:",r),g.error("Failed to load product details"),r}}});return t?e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsx(w,{className:"aspect-square w-full"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(w,{className:"h-8 w-3/4"}),e.jsx(w,{className:"h-6 w-1/4"}),e.jsx(w,{className:"h-24 w-full"}),e.jsx(w,{className:"h-10 w-1/3"})]})]})}):a?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsx(ue,{images:((l=a.product_images)==null?void 0:l.map(r=>({url:r.image_url,alt:a.name})))||[{url:a.image_url||"/placeholder.svg",alt:a.name}],productName:a.name}),e.jsx(fe,{product:a})]}),e.jsxs(K,{defaultValue:"details",className:"mt-12",children:[e.jsxs(G,{className:"w-full",children:[e.jsx(S,{value:"details",className:"flex-1",children:"Details"}),e.jsx(S,{value:"shipping",className:"flex-1",children:"Shipping"}),e.jsx(S,{value:"reviews",className:"flex-1",children:"Reviews"})]}),e.jsx(k,{value:"details",className:"mt-4",children:e.jsxs(W,{type:"single",collapsible:!0,children:[e.jsxs(I,{value:"description",children:[e.jsx(T,{children:"Product Description"}),e.jsx(_,{children:a.description||"Detailed product description will be available soon."})]}),e.jsxs(I,{value:"specifications",children:[e.jsx(T,{children:"Specifications"}),e.jsx(_,{children:e.jsxs("ul",{className:"list-disc pl-4 space-y-2",children:[e.jsx("li",{children:"Material: Premium quality materials"}),e.jsx("li",{children:"Dimensions: Custom sizes available"}),e.jsxs("li",{children:["Origin: ",a.origin_country||"Made in Africa"]}),e.jsxs("li",{children:["Category: ",a.category]})]})})]})]})}),e.jsx(k,{value:"shipping",className:"mt-4",children:e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("p",{children:"Free shipping on orders over $100"}),e.jsx("p",{children:"Estimated delivery: 5-7 business days"}),e.jsx("p",{children:"International shipping available to select countries"}),e.jsx("p",{children:"All items are carefully packaged to ensure safe delivery"})]})}),e.jsx(k,{value:"reviews",className:"mt-4",children:e.jsx(Ce,{productId:a.id})})]}),e.jsx("div",{className:"mt-12",children:e.jsx(ge,{products:[],currentProductId:a.id})})]}):e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Product not found"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"The product you're looking for doesn't exist or has been removed."})]})})};export{Le as default};
//# sourceMappingURL=ProductDetails-CPNydXOk.js.map
